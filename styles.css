/* =========================================================
   Professional Design System - Uber-inspired
   ========================================================= */
:root {
  /* Light theme defaults */
  --bg:#f6f6f6;
  --bg-surface:#ffffff;
  --bg-elevated:#fafafa;
  --panel:#ffffff;
  --text:#000000;
  --text-secondary:#545454;
  --text-tertiary:#939393;
  --accent:#000000;
  --accent-hover:#333333;
  --primary:#06c167;
  --primary-hover:#05ab5a;
  --danger:#cd0000;
  --danger-hover:#b30000;
  --ok:#06c167;
  --warn:#ffb000;
  --border:#e2e2e2;
  --border-strong:#d4d4d4;
  --divider:#eeeeee;
  --radius-sm:4px;
  --radius-md:8px;
  --radius-lg:12px;
  --shadow-sm:0 1px 2px rgba(0,0,0,0.04);
  --shadow-md:0 2px 8px rgba(0,0,0,0.08);
  --shadow-lg:0 4px 16px rgba(0,0,0,0.12);
  --shadow-xl:0 8px 24px rgba(0,0,0,0.16);
  --sidebar-width:380px;
  --transition-fast:150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-base:250ms cubic-bezier(0.4, 0, 0.2, 1);
}

[data-theme="dark"] {
  --bg:#0d0d0d;
  --bg-surface:#1a1a1a;
  --bg-elevated:#242424;
  --panel:#1a1a1a;
  --text:#ffffff;
  --text-secondary:#afafaf;
  --text-tertiary:#6f6f6f;
  --accent:#ffffff;
  --accent-hover:#e6e6e6;
  --primary:#00d66f;
  --primary-hover:#00c264;
  --danger:#ff4646;
  --danger-hover:#ff2929;
  --ok:#00d66f;
  --warn:#ffc107;
  --border:#333333;
  --border-strong:#444444;
  --divider:#2a2a2a;
  --shadow-sm:0 1px 2px rgba(0,0,0,0.3);
  --shadow-md:0 2px 8px rgba(0,0,0,0.4);
  --shadow-lg:0 4px 16px rgba(0,0,0,0.5);
  --shadow-xl:0 8px 24px rgba(0,0,0,0.6);
}

* { box-sizing:border-box; }
html, body { height:100%; }

body {
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;
  font-size:14px;
  line-height:1.5;
  font-weight:400;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  display:flex;
  flex-direction:column;
}

/* =========================================================
   Top Bar
   ========================================================= */
.topbar {
  position:sticky;
  top:0;
  z-index:1000;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 24px;
  height:64px;
  background:var(--bg-surface);
  border-bottom:1px solid var(--border);
  box-shadow:var(--shadow-sm);
}
.topbar h1 {
  margin:0;
  font-size:20px;
  font-weight:600;
  letter-spacing:-0.3px;
  color:var(--text);
}
.controls {
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  align-items:center;
}
.controls button,
.file-btn span {
  background:var(--bg-surface);
  color:var(--text);
  border:1px solid var(--border);
  padding:10px 16px;
  border-radius:var(--radius-md);
  cursor:pointer;
  font-size:14px;
  font-weight:500;
  transition:all var(--transition-fast);
  white-space:nowrap;
}
.controls button:hover,
.file-btn span:hover {
  background:var(--bg-elevated);
  border-color:var(--border-strong);
}
.controls button:active,
.file-btn span:active {
  transform:scale(0.98);
}
.file-btn { position:relative; overflow:hidden; display:inline-block; }
.file-btn input { position:absolute; inset:0; opacity:0; cursor:pointer; }

/* =========================================================
   Layout & Video Panel
   ========================================================= */
.layout {
  flex:1;
  min-height:0;
  display:grid;
  grid-template-columns: 1fr 1px var(--sidebar-width);
  gap:0;
}
.player-panel {
  display:flex;
  flex-direction:column;
  min-width:0;
  overflow:hidden;
  background:var(--bg-surface);
}
.video-container {
  position:relative;
  flex:1;
  min-height:0;
  background:#000000;
  display:flex;
  align-items:center;
  justify-content:center;
}
video { max-width:100%; max-height:100%; width:auto; height:auto; object-fit:contain; display:block; }
.overlay { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); pointer-events:none; }

.hud { position:absolute; inset:0; pointer-events:none; z-index:10; }
.center-status {
  position:absolute;
  left:50%; top:50%; transform:translate(-50%,-50%);
  font-size:48px;
  font-weight:700;
  color:rgba(255,255,255,0.9);
  text-shadow:0 2px 8px rgba(0,0,0,0.3);
  opacity:0;
  transition:opacity var(--transition-base);
}
.center-status.show { opacity:1; }
.mini-controls {
  position:absolute;
  left:20px; bottom:20px;
  display:flex;
  gap:8px;
  padding:8px;
  border-radius:var(--radius-md);
  background:rgba(0,0,0,0.75);
  backdrop-filter:blur(10px);
  opacity:0;
  transform:translateY(8px);
  transition:all var(--transition-base);
  pointer-events:auto;
}
.mini-controls button {
  padding:8px 16px;
  border-radius:var(--radius-sm);
  border:none;
  background:rgba(255,255,255,0.15);
  color:#ffffff;
  cursor:pointer;
  font-size:14px;
  font-weight:500;
  transition:all var(--transition-fast);
}
.mini-controls button:hover {
  background:rgba(255,255,255,0.25);
}
.video-container:hover .mini-controls { opacity:1; transform:translateY(0); }

.placeholder {
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  background:var(--bg-surface);
}
.ph-inner {
  background:var(--bg-surface);
  border:2px dashed var(--border);
  border-radius:var(--radius-lg);
  padding:48px;
  text-align:center;
  max-width:400px;
}
.ph-title {
  font-size:18px;
  font-weight:600;
  margin-bottom:8px;
  color:var(--text);
}
.ph-sub {
  font-size:14px;
  color:var(--text-secondary);
  line-height:1.5;
}

.player-controls {
  display:flex;
  align-items:center;
  gap:16px;
  padding:16px 24px;
  background:var(--bg-surface);
  border-top:1px solid var(--border);
}
.primary {
  background:var(--primary);
  color:#ffffff;
  border:none;
  font-weight:600;
}
.primary:hover {
  background:var(--primary-hover);
  border:none;
}
.danger {
  background:var(--danger);
  color:#ffffff;
  border:none;
  font-weight:600;
}
.danger:hover {
  background:var(--danger-hover);
  border:none;
}

.tool-group {
  display:flex;
  align-items:center;
  gap:8px;
  background:var(--bg-elevated);
  border:1px solid var(--border);
  padding:4px;
  border-radius:var(--radius-md);
}
.tool {
  padding:8px 16px;
  border-radius:var(--radius-sm);
  border:none;
  background:transparent;
  color:var(--text);
  cursor:pointer;
  font-size:14px;
  font-weight:500;
  transition:all var(--transition-fast);
}
.tool:hover { background:var(--bg-surface); }
.tool.active {
  background:var(--accent);
  color:#ffffff;
}
.swatch input { width:32px; height:32px; padding:0; border:1px solid var(--border); border-radius:var(--radius-sm); background:transparent; cursor:pointer; }
.width { display:flex; align-items:center; gap:8px; color:var(--text-secondary); font-size:14px; }
#widthInput { width:120px; }
#widthVal { min-width:40px; text-align:right; color:var(--text); font-weight:500; }

/* =========================================================
   Transport + Timeline
   ========================================================= */
.transport {
  display:flex;
  flex-direction:column;
  gap:16px;
  padding:16px 24px;
  background:var(--bg-surface);
  border-top:1px solid var(--border);
}
.transport-row { display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; }
.tbtn {
  padding:10px 16px;
  border-radius:var(--radius-md);
  border:1px solid var(--border);
  background:var(--bg-surface);
  color:var(--text);
  cursor:pointer;
  min-width:56px;
  font-size:14px;
  font-weight:500;
  transition:all var(--transition-fast);
}
.tbtn:hover {
  background:var(--bg-elevated);
  border-color:var(--border-strong);
}
.tbtn.primary {
  background:var(--primary);
  color:#ffffff;
  border:none;
}
.tbtn.primary:hover {
  background:var(--primary-hover);
}
.tbtn:active { transform:scale(0.98); }

.markers-row { display:flex; align-items:center; justify-content:space-between; gap:16px; flex-wrap:wrap; }
.marks { display:flex; align-items:center; gap:8px; }
.snap-label { display:flex; align-items:center; gap:8px; color:var(--text-secondary); font-size:14px; }
.snap-label input[type="checkbox"] { cursor:pointer; width:16px; height:16px; }
.zoom label { display:flex; align-items:center; gap:12px; color:var(--text-secondary); font-size:14px; }
.zoom input { width:200px; }

.an-row { display:flex; align-items:center; justify-content:space-between; gap:16px; color:var(--text-secondary); font-size:14px; }
.an-meters { display:flex; gap:20px; font-variant-numeric:tabular-nums; }
.an-meters .an-label { color:var(--text-secondary); margin-right:6px; }
.an-meters .ok { color:var(--ok); font-weight:600; }
.an-meters .warn { color:var(--warn); font-weight:600; }
.an-meters .bad { color:var(--danger); font-weight:600; }

.timeline-row { display:grid; grid-template-columns: 160px 1fr; align-items:center; gap:20px; }
.time-display { color:var(--text); font-variant-numeric:tabular-nums; font-size:14px; font-weight:500; }
.timeline {
  position:relative;
  height:48px;
  border-radius:var(--radius-md);
  border:1px solid var(--border);
  background:var(--bg-elevated);
  overflow:hidden;
}
.timeline canvas { position:absolute; inset:0; width:100%; height:100%; }
.timeline::after { content:""; position:absolute; inset:0; pointer-events:none; }

/* =========================================================
   Sidebar
   ========================================================= */
.splitter { background:var(--border); cursor:col-resize; transition:background var(--transition-fast); }
.splitter:hover { background:var(--border-strong); }

.list-panel {
  border-left:1px solid var(--border);
  background:var(--bg);
  display:flex;
  flex-direction:column;
  min-width:240px;
  min-height:0;
  overflow:hidden;
}
.panel-top {
  position:sticky;
  top:0;
  z-index:100;
  background:var(--bg);
  border-bottom:1px solid var(--border);
}
.list-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:20px 24px;
  border-bottom:1px solid var(--border);
}
.list-header h2 {
  margin:0;
  font-size:18px;
  font-weight:600;
  color:var(--text);
}
.filters {
  display:flex;
  flex-direction:column;
  gap:12px;
  padding:16px 24px;
  border-bottom:1px solid var(--border);
}
.filters label {
  display:flex;
  flex-direction:column;
  gap:6px;
  font-size:13px;
  font-weight:500;
  color:var(--text-secondary);
  text-transform:uppercase;
  letter-spacing:0.5px;
}
.filters select,
.filters input {
  background:var(--bg-surface);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:10px 12px;
  font-size:14px;
  transition:all var(--transition-fast);
}
.filters select:focus,
.filters input:focus {
  outline:none;
  border-color:var(--accent);
}

.notes.card {
  margin:20px 24px 0;
  background:var(--bg-surface);
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  padding:16px;
  box-shadow:var(--shadow-sm);
}
.notes .row { margin-bottom:12px; }
.notes .meta { font-size:13px; font-weight:600; color:var(--text); text-transform:uppercase; letter-spacing:0.5px; }
.notes textarea {
  width:100%;
  background:var(--bg-elevated);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:12px;
  resize:vertical;
  font-size:14px;
  line-height:1.5;
  transition:all var(--transition-fast);
}
.notes textarea:focus {
  outline:none;
  border-color:var(--accent);
}

.annotation-list { flex:1; min-height:0; overflow:auto; padding:24px; }
.card {
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  padding:16px;
  margin-bottom:16px;
  background:var(--bg-surface);
  box-shadow:var(--shadow-sm);
  transition:all var(--transition-fast);
}
.card:hover {
  box-shadow:var(--shadow-md);
  border-color:var(--border-strong);
}
.card.closest {
  border-color:var(--primary);
  box-shadow:0 0 0 2px rgba(6,193,103,0.15);
}
.card.selected {
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(0,0,0,0.1);
}
.card .row {
  display:flex;
  justify-content:space-between;
  gap:12px;
  color:var(--text-secondary);
  font-size:13px;
}
.card .meta { display:flex; gap:8px; align-items:center; }
.card input[type="text"] {
  background:var(--bg-elevated);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:8px 12px;
  font-size:14px;
  transition:all var(--transition-fast);
}
.card input[type="text"]:focus {
  outline:none;
  border-color:var(--accent);
}
.card textarea {
  width:100%;
  margin-top:12px;
  background:var(--bg-elevated);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:12px;
  resize:vertical;
  min-height:80px;
  font-size:14px;
  line-height:1.5;
  transition:all var(--transition-fast);
}
.card textarea:focus {
  outline:none;
  border-color:var(--accent);
}
.chips { display:flex; flex-wrap:wrap; gap:8px; margin-top:12px; }
.chip {
  padding:6px 12px;
  border-radius:99px;
  border:1px solid var(--border);
  background:var(--bg-elevated);
  color:var(--text);
  font-size:13px;
  font-weight:500;
  cursor:pointer;
  transition:all var(--transition-fast);
}
.chip:hover {
  background:var(--bg-surface);
  border-color:var(--border-strong);
}
.actions { display:flex; gap:8px; margin-top:16px; }
.actions button {
  padding:10px 16px;
  border-radius:var(--radius-md);
  border:1px solid var(--border);
  background:var(--bg-surface);
  color:var(--text);
  cursor:pointer;
  font-size:14px;
  font-weight:500;
  transition:all var(--transition-fast);
}
.actions button:hover {
  background:var(--bg-elevated);
  border-color:var(--border-strong);
}

/* =========================================================
   Dialogs & Footer
   ========================================================= */
dialog {
  border:1px solid var(--border);
  border-radius:var(--radius-lg);
  background:var(--bg-surface);
  color:var(--text);
  padding:32px;
  box-shadow:var(--shadow-xl);
  max-width:600px;
}
dialog::backdrop {
  background:rgba(0,0,0,0.5);
  backdrop-filter:blur(4px);
}
dialog form h3 {
  margin:0 0 20px;
  font-size:20px;
  font-weight:600;
  color:var(--text);
}
dialog form ul {
  margin:0;
  padding-left:20px;
  line-height:1.8;
}
dialog form label {
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:16px;
  font-size:14px;
  color:var(--text-secondary);
}
textarea {
  width:100%;
  background:var(--bg-elevated);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:12px;
  resize:vertical;
  font-size:14px;
  line-height:1.5;
  transition:all var(--transition-fast);
}
textarea:focus {
  outline:none;
  border-color:var(--accent);
}
menu {
  display:flex;
  justify-content:flex-end;
  gap:12px;
  margin-top:24px;
  padding:0;
}
menu button {
  padding:12px 24px;
  border-radius:var(--radius-md);
  border:1px solid var(--border);
  background:var(--bg-surface);
  color:var(--text);
  cursor:pointer;
  font-size:14px;
  font-weight:500;
  transition:all var(--transition-fast);
}
menu button:hover {
  background:var(--bg-elevated);
  border-color:var(--border-strong);
}
menu .primary {
  background:var(--accent);
  color:#ffffff;
  border:none;
}
menu .primary:hover {
  background:var(--accent-hover);
}

.footer {
  padding:16px 24px;
  border-top:1px solid var(--border);
  color:var(--text-secondary);
  background:var(--bg-surface);
  font-size:13px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:16px;
}
.footer .version {
  font-weight:600;
  color:var(--text-tertiary);
  font-size:12px;
}

/* =========================================================
   Export Dialog
   ========================================================= */
.export-dialog { width:90vw; max-width:900px; }
.export-options {
  display:flex;
  flex-direction:column;
  gap:12px;
  margin-bottom:20px;
}
.export-options label {
  display:flex;
  align-items:center;
  gap:8px;
  font-size:14px;
  color:var(--text);
}
.export-body {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:20px;
  margin:20px 0;
}
.export-left { display:flex; flex-direction:column; gap:12px; }
.export-list {
  max-height:400px;
  overflow-y:auto;
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:12px;
  background:var(--bg-elevated);
}
.export-list label {
  display:flex;
  align-items:center;
  gap:8px;
  padding:8px;
  font-size:14px;
  color:var(--text);
  cursor:pointer;
  border-radius:var(--radius-sm);
  transition:background var(--transition-fast);
}
.export-list label:hover {
  background:var(--bg-surface);
}
.export-right { display:flex; flex-direction:column; gap:12px; }
.export-actions {
  display:flex;
  gap:8px;
}
.export-actions button {
  flex:1;
  padding:10px 16px;
  border-radius:var(--radius-md);
  border:1px solid var(--border);
  background:var(--bg-surface);
  color:var(--text);
  cursor:pointer;
  font-size:14px;
  font-weight:500;
  transition:all var(--transition-fast);
}
.export-actions button:hover {
  background:var(--bg-elevated);
  border-color:var(--border-strong);
}
.export-actions .primary {
  background:var(--primary);
  color:#ffffff;
  border:none;
}
.export-actions .primary:hover {
  background:var(--primary-hover);
}
.export-preview {
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:16px;
  background:var(--bg-elevated);
  min-height:300px;
  overflow-y:auto;
}
.export-preview .muted {
  color:var(--text-secondary);
  font-size:14px;
}
#expStatus {
  font-size:13px;
  color:var(--text-secondary);
}

/* =========================================================
   Input Elements
   ========================================================= */
input[type="number"],
input[type="text"]:not(.card input[type="text"]) {
  background:var(--bg-elevated);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:8px 12px;
  font-size:14px;
  transition:all var(--transition-fast);
}
input[type="number"]:focus,
input[type="text"]:focus {
  outline:none;
  border-color:var(--accent);
}
input[type="range"] {
  cursor:pointer;
  accent-color:var(--primary);
}
input[type="checkbox"] {
  cursor:pointer;
  width:16px;
  height:16px;
  accent-color:var(--primary);
}
select {
  cursor:pointer;
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width:8px;
  height:8px;
}
::-webkit-scrollbar-track {
  background:transparent;
}
::-webkit-scrollbar-thumb {
  background:var(--border-strong);
  border-radius:4px;
}
::-webkit-scrollbar-thumb:hover {
  background:var(--text-tertiary);
}

/* =========================================================
   Responsive
   ========================================================= */
@media (max-width: 1024px) {
  .layout { grid-template-columns: 1fr; }
  .splitter { display:none; }
  .list-panel { order:2; border-left:none; border-top:1px solid var(--border); }
  .export-body { grid-template-columns:1fr; }
}

@media (max-width: 768px) {
  .topbar { height:auto; padding:16px; flex-direction:column; gap:12px; align-items:flex-start; }
  .topbar h1 { font-size:18px; }
  .controls { width:100%; justify-content:flex-start; }
  .controls button, .file-btn span { flex:1 1 auto; min-width:120px; }
  .transport-row, .markers-row, .an-row { flex-wrap:wrap; }
  .timeline-row { grid-template-columns: 1fr; }
  dialog { padding:20px; max-width:90vw; }
}
